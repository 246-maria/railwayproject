{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/book.css' %}?v=1.2">
    <title>Book Ticket</title>

</head>
<body>

    <div class="container">
        <h2>
            <img src="{% static 'images/logo.jpg' %}" alt="My Logo">
            Book Your Ticket
        </h2>

        {% if messages %}
            {% for message in messages %}
                <div style="margin-bottom:10px; padding:8px; border-radius:5px; border:1px solid #ccc; background:#f1f1f1;">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <div id="js-error-message" class="error-message"></div>

        <form id="booking-form" method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <label>Name:</label>
            <input type="text" name="full_name" value="{{ user.full_name }}">

            <label>Email:</label>
            <input type="email" value="{{ user.email }}" readonly>

            <label>Mobile:</label>
            <input type="text" value="{{ user.mobile }}" readonly>

            <label>Train:</label>
            <p>{{ train.train_name }}</p>
            <input type="hidden" name="train_id" value="{{ train.id }}">

            <label>From Station:</label>
            <input type="text" name="from_station" value="{{ train.from_station }}" readonly>

            <label>To Station:</label>
            <input type="text" name="to_station" value="{{ train.to_station }}" readonly>

            <label>Class:</label>
            <input type="text" name="travel_class" value="{{ travel_class }}" readonly>

            <label>No. of Passengers:</label>
            <input type="number" name="no_of_passengers" value="{{ no_of_passenger }}" readonly>

            <label>Total Fare:</label>
            <input type="text" name="total_fare" value="{{ total_fare }}" readonly>

            <label>Payment Method:</label>
            <select name="payment_method" id="payment_method" required>
                <option value="">-- Select --</option>
                <option value="JazzCash">JazzCash (03030845656)</option>
                <option value="EasyPaisa">EasyPaisa (03456231390)</option>
            </select>

            <label>Upload Payment Screenshot:</label>
            <input type="file" name="payment_screenshot" id="payment_screenshot" accept="image/*" required>

            <button type="submit">Confirm Booking</button>
        </form>
    </div>

<script>
    document.getElementById('booking-form').addEventListener('submit', function(event) {
        const paymentMethod = document.getElementById('payment_method').value;
        const screenshotFile = document.getElementById('payment_screenshot').files[0];
        const errorMessageDiv = document.getElementById('js-error-message');
        
        errorMessageDiv.textContent = '';

        if (!paymentMethod) {
            errorMessageDiv.textContent = 'Please select a payment method.';
            event.preventDefault();
            return;
        }

        if (!screenshotFile) {
            errorMessageDiv.textContent = 'Please upload a payment screenshot.';
            event.preventDefault();
            return;
        }
    });
</script>

</body>
</html>
